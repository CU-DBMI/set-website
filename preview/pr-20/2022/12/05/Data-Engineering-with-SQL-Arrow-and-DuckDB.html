<!DOCTYPE html>
<html lang="en" data-dark="false">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <!--
  put your analytics (e.g. Google Analytics) tracking code here
-->

  <!--
  put your search engine verification (e.g. Google Search Console) tag here
-->

  

























<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Tip of the Week: Data Engineering with SQL, Arrow and DuckDB | Software Engineering Team</title>

<link rel="icon" href="/set-website/preview/pr-20/images/icon.png">

<meta name="title" content="Tip of the Week: Data Engineering with SQL, Arrow and DuckDB">
<meta name="description" content="The software engineering team of the Department of Biomedical Informatics at the University of Colorado Anschutz">

<meta property="og:title" content="Tip of the Week: Data Engineering with SQL, Arrow and DuckDB">
<meta property="og:site_title" content="Software Engineering Team">
<meta property="og:description" content="The software engineering team of the Department of Biomedical Informatics at the University of Colorado Anschutz">
<meta property="og:url" content="">
<meta property="og:image" content="/set-website/preview/pr-20/images/share.jpg">
<meta property="og:locale" content="en_US">

<meta property="twitter:title" content="Tip of the Week: Data Engineering with SQL, Arrow and DuckDB">
<meta property="twitter:description" content="The software engineering team of the Department of Biomedical Informatics at the University of Colorado Anschutz">
<meta property="twitter:url" content="">
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:image" content="/set-website/preview/pr-20/images/share.jpg">


  <meta name="author" content="dave-bunten">
  <meta property="og:type" content="article">
  <meta property="og:updated_time" content="2023-06-09T17:51:59+00:00">
  <meta property="article:published_time" content="2022-12-05T00:00:00+00:00">
  <meta property="article:modified_time" content="2023-06-09T17:51:59+00:00">
  <meta name="revised" content="2023-06-09T17:51:59+00:00">


<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "BlogPosting",
      "author": { "@type": "Person", "name": "Tip of the Week: Data Engineering with SQL, Arrow and DuckDB" },
      "datePublished": "2022-12-05T00:00:00+00:00",
      "dateModified": "2023-06-09T17:51:59+00:00",
    
    "name": "Tip of the Week: Data Engineering with SQL, Arrow and DuckDB",
    "description": "The software engineering team of the Department of Biomedical Informatics at the University of Colorado Anschutz",
    "headline": "Tip of the Week: Data Engineering with SQL, Arrow and DuckDB",
    "publisher": {
      "@type": "Organization",
      "logo": { "@type": "ImageObject", "url": "/set-website/preview/pr-20/images/icon.png" }
    },
    "url": ""
  }
</script>

<link rel="alternate" type="application/rss+xml" href="/set-website/preview/pr-20/feed.xml">

  <!-- Google Fonts -->
<!-- automatically get url from fonts used in theme file -->

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?display=swap&&family=Barlow:ital,wght@0,200;0,400;0,500;0,600;1,200;1,400;1,500;1,600&amp;family=Roboto+Mono:ital,wght@0,200;0,400;0,500;0,600;1,200;1,400;1,500;1,600" rel="stylesheet">

<!-- Font Awesome icons (load asynchronously due to size) -->

<link href="https://use.fontawesome.com/releases/v6.3.0/css/all.css" rel="preload" as="style" onload="this.onload = null; this.rel = 'stylesheet';">
<noscript>
  <link href="https://use.fontawesome.com/releases/v6.3.0/css/all.css" rel="stylesheet">
</noscript>

  <!-- third party styles -->
<!-- https://stylishthemes.github.io/Syntax-Themes/pygments/ -->
<link href="https://cdn.jsdelivr.net/gh/StylishThemes/Syntax-Themes/pygments/css-github/pygments-tomorrow-night-eighties.css" rel="stylesheet">

<!-- include all sass in styles folder -->


  
    <link href="/set-website/preview/pr-20/_styles/-theme.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/alert.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/all.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/anchor.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/background.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/body.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/bold.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/button.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/card.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/checkbox.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/citation.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/code.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/cols.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/dark-toggle.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/feature.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/figure.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/float.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/font.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/footer.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/form.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/grid.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/header.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/heading.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/highlight.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/icon.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/image.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/link.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/list.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/main.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/paragraph.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/portrait.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/post-excerpt.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/post-info.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/post-nav.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/quote.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/rule.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/search-box.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/search-info.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/section.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/table.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/tags.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/textbox.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/tooltip.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-20/_styles/util.css" rel="stylesheet">
  


<!-- include all css in styles folder -->



  <!-- third party scripts -->
<script src="https://unpkg.com/@popperjs/core@2" defer></script>
<script src="https://unpkg.com/tippy.js@6" defer></script>
<script src="https://unpkg.com/mark.js@8" defer></script>

<!-- include all js in scripts folder -->


  <script src="/set-website/preview/pr-20/_scripts/anchors.js"></script>

  <script src="/set-website/preview/pr-20/_scripts/dark-mode.js"></script>

  <script src="/set-website/preview/pr-20/_scripts/fetch-tags.js"></script>

  <script src="/set-website/preview/pr-20/_scripts/search.js"></script>

  <script src="/set-website/preview/pr-20/_scripts/site-search.js"></script>

  <script src="/set-website/preview/pr-20/_scripts/tooltip.js"></script>


</head>

  <body>
    







<header class="background" style="--image: url('/set-website/preview/pr-20/images/background.jpg')" data-dark="true">
  <a href="/set-website/preview/pr-20/" class="home">
    
      <span class="logo">
        
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="-60 -50 120 100">
  <defs>
    <lineargradient id="gradient">
      <stop stop-color="#7e57c2" offset="0%"></stop>
      <stop stop-color="#2196f3" offset="100%"></stop>
    </lineargradient>
  </defs>
  <path fill="none" stroke="url(#gradient)" stroke-width="8" stroke-linecap="round" stroke-linejoin="round" d="
      M -30 -20
      L -50 0
      L -30 20
      M 30 -20
      L 50 0
      L 30 20
      M 10 -30
      L -10 30
    "></path>
</svg>

        
      </span>
    
    
      <span class="title" data-tooltip="Home">
        
          <span>Software Engineering Team</span>
        
        
          <span>CU Department of Biomedical Informatics</span>
        
      </span>
    
  </a>

  <input class="nav-toggle" type="checkbox" aria-label="show/hide nav">

  <nav>
    
    
      
        <a href="/set-website/preview/pr-20/about/" data-tooltip="">
          About
        </a>
      
    
      
        <a href="/set-website/preview/pr-20/portfolio/" data-tooltip="">
          Portfolio
        </a>
      
    
      
        <a href="/set-website/preview/pr-20/blog/" data-tooltip="Musings and miscellany">
          Blog
        </a>
      
    
  </nav>
</header>

    <main>
      <!--
  modify main content of page:
  - add section breaks
  - attach section properties
  - wrap each table in div to allow for scrolling
  - filter out blank sections
-->








  
  
  

  <section class="background" data-size="page">
    <h1 class="center">Tip of the Week: Data Engineering with SQL, Arrow and DuckDB</h1>

<div class="post-info">
  
    
    
      

<div class="portrait-wrapper">
  <a href="/set-website/preview/pr-20/members/dave-bunten.html" class="portrait" data-style="tiny" aria-label="Dave Bunten">
    <img src="/set-website/preview/pr-20/images/dave-bunten.jpg" class="portrait-image" alt="member portrait" loading="lazy" onerror="this.src = '/set-website/preview/pr-20/images/fallback.svg'; this.onerror = null;">

    
      <span class="portrait-text">
        
          <span class="portrait-name">
            Dave Bunten
          </span>
        

        
          <span class="portrait-role">
            
            <i class="icon fa-solid fa-code"></i>
            <span>Research Data Engineer</span>
          </span>
        
      </span>
    
  </a>
</div>

    
  

  
  

  
    <span data-tooltip="Originally published on">
      <i class="icon fa-regular fa-calendar"></i>
      <span>December 05, 2022</span>
    </span>
  

  
    <span data-tooltip="Last updated on">
      <i class="icon fa-solid fa-clock-rotate-left"></i>
      <span>June 09, 2023</span>
    </span>
  
</div>


  


  <div class="tags" data-link="/set-website/preview/pr-20/blog">
    
      <a href="/set-website/preview/pr-20/blog?search=%22tag:%20tip-of-the-week%22" class="tag" data-tooltip='Show items with the tag "tip-of-the-week"'>
        tip-of-the-week
      </a>
    
      <a href="/set-website/preview/pr-20/blog?search=%22tag:%20software%22" class="tag" data-tooltip='Show items with the tag "software"'>
        software
      </a>
    
      <a href="/set-website/preview/pr-20/blog?search=%22tag:%20data%22" class="tag" data-tooltip='Show items with the tag "data"'>
        data
      </a>
    
      <a href="/set-website/preview/pr-20/blog?search=%22tag:%20sql%22" class="tag" data-tooltip='Show items with the tag "sql"'>
        sql
      </a>
    
      <a href="/set-website/preview/pr-20/blog?search=%22tag:%20dataframes%22" class="tag" data-tooltip='Show items with the tag "dataframes"'>
        dataframes
      </a>
    
      <a href="/set-website/preview/pr-20/blog?search=%22tag:%20arrow%22" class="tag" data-tooltip='Show items with the tag "arrow"'>
        arrow
      </a>
    
      <a href="/set-website/preview/pr-20/blog?search=%22tag:%20duckdb%22" class="tag" data-tooltip='Show items with the tag "duckdb"'>
        duckdb
      </a>
    
  </div>
  </section>

  
  
  

  <section class="background" data-size="page">
    <!--
  background: ;
  dark: ;
  size: ;
-->


<h1 id="tip-of-the-week-data-engineering-with-sql-arrow-and-duckdb">Tip of the Week: Data Engineering with SQL, Arrow and DuckDB</h1>

<blockquote>
  <p>Each week we seek to provide a software tip of the week geared towards helping you achieve your software goals. If you have any software questions or suggestions for an upcoming tip of the week, please don’t hesitate to reach out to #software-engineering on Slack or email DBMISoftwareEngineering at olucdenver.onmicrosoft.com</p>
</blockquote>

<!-- excerpt start -->

<p><a href="https://arrow.apache.org/">Apache Arrow</a> is a language-independent and high performance data format useful in many scenarios. <a href="https://duckdb.org/">DuckDB</a> is an in-process <a href="https://en.wikipedia.org/wiki/SQL">SQL</a>-based data management system which is Arrow-compatible. In addition to providing a <a href="https://sqlite.org/index.html">SQLite</a>-like database format, DuckDB also provides a standardized and high performance way to work with Arrow data where otherwise one may be forced to language-specific data structures or transforms.</p>

<!-- excerpt end -->

<p><strong>TLDR (too long, didn’t read);</strong>
DuckDB may be used to access and transform Arrow-based data from multiple data formats through SQL. Using Arrow and DuckDB provides a cross-language way to access and manage data. Data development with these tools may also enable improvements in performance, understandability, or long term maintainability of your code.</p>

<h2 id="reduce-wasted-conversion-effort-with-arrow">Reduce Wasted Conversion Effort with Arrow</h2>

<pre class="mermaid">
flowchart TB
    Python:::outlined &lt;--&gt; Arrow
    R:::outlined &lt;--&gt; Arrow
    C++:::outlined &lt;--&gt; Arrow
    Java:::outlined &lt;--&gt; Arrow
    others...:::outlined &lt;--&gt; Arrow

    classDef outlined fill:#fff,stroke:#333
</pre>
<script type="module">
  import mermaid from 'https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true });
</script>

<p>Arrow provides a <a href="https://arrow.apache.org/docs/">multi-language</a> data format which prevents you from needing to convert to other formats when dealing with multiple in-memory or serialized data formats. For example, this means that a Python and an R package may use the same in-memory or file-based data without conversion (where normally a Python Pandas dataframe and R data frame may require a conversion step in between).</p>

<pre class="mermaid">
flowchart TB
    subgraph Python
      Pandas:::outlined
      Polars:::outlined
      dict[Python dict]:::outlined
      list[Python list]:::outlined
    end

    Pandas &lt;--&gt; Arrow
    Polars &lt;--&gt; Arrow
    dict &lt;--&gt; Arrow
    list &lt;--&gt; Arrow

  classDef outlined fill:#fff,stroke:#333
</pre>

<p>The same stands for various libraries within one language - Arrow enables interchange between various language library formats (for example, a Python Pandas dataframe and Python dictionary are two distinct in-memory formats which may require conversions). Conversions to or from these formats can involve data type or other inferences which are costly to productivity. You can save time and effort by avoiding conversions using Arrow.</p>

<h2 id="using-sql-to-join-or-transform-arrow-data-via-duckdb">Using SQL to Join or Transform Arrow Data via DuckDB</h2>

<pre class="mermaid">
flowchart LR
    subgraph duckdb["DuckDB Processing"]
        direction BT
        SQL[SQL] --&gt; DuckDB[DuckDB Client]
    end
    parquet1[example.parquet] --&gt; duckdb
    sqlite[example.sqlite] --&gt; duckdb
    csv[example.csv] --&gt; duckdb
    arrow["in-memory Arrow"] --&gt; duckdb
    pandas["in-memory Pandas"] --&gt; duckdb
    duckdb --&gt; Arrow
    Arrow --&gt; Other[Other work...]
</pre>

<p>DuckDB provides a management client and relational database format (similar to SQLite databases) which may be handled with Arrow. SQL may be used with the DuckDB client to filter, join, or change various data types. Due to Arrow’s cross-language properties, there is no additional cost to using SQL through DuckDB to return data for implementation within other purpose-built data formats. <a href="https://duckdb.org/docs/api/overview">DuckDB provides client API’s in many languages</a> (for example, Python, R, and C++), making it possible to write DuckDB client code with SQL to manage data without having to use manually written sub-procedures.</p>

<pre class="mermaid">
flowchart TB
  subgraph duckdb["DuckDB Processing"]
        direction BT
        SQL[SQL] --&gt; DuckDB[DuckDB Client]
    end
    Python:::outlined &lt;--&gt; duckdb
    R:::outlined &lt;--&gt; duckdb
    C++:::outlined &lt;--&gt; duckdb
    Java:::outlined &lt;--&gt; duckdb
    others...:::outlined &lt;--&gt; duckdb
    duckdb &lt;--&gt; Arrow

    classDef outlined fill:#fff,stroke:#333
</pre>

<p>Using SQL to perform these operations with Arrow provides an opportunity for your data code to be used (or understood) within other languages without additional rewrites. SQL also provides you access to roughly 48 years worth of data management improvements without being constrained by imperative language data models or schema (reference: <a href="https://en.wikipedia.org/wiki/SQL">SQL Wikipedia: <em>First appeared: 1974</em></a>).</p>

<h2 id="example-with-sql-to-join-arrow-data-with-duckdb-in-python">Example with SQL to Join Arrow Data with DuckDB in Python</h2>

<figure class="figure">
  <a class="figure-image" aria-label="Jupyter notebook example screenshot with DuckDB and Arrow data handling">
    <img src="/set-website/preview/pr-20/images/duckdb_arrow_query_example.png" style="
        width: 500px;
        max-height: unset;
      " alt="Jupyter notebook example screenshot with DuckDB and Arrow data handling" loading="lazy" onerror="this.src = '/set-website/preview/pr-20/images/fallback.svg'; this.onerror = null;">
  </a>
  
    <figcaption class="figure-caption">
      Jupyter notebook example screenshot with DuckDB and Arrow data handling

    </figcaption>
  
</figure>

<p>The following example notebook shows how to use SQL to join data from multiple sources using the DuckDB client API within Python. The example includes DuckDB querying a remote CSV, local Parquet file, and Arrow in-memory tables.</p>

<p><a href="https://github.com/CU-DBMI/notebooks/blob/main/content/arrow_and_duckdb_example.ipynb">Linked Example</a></p>

<h2 id="additional-resources">Additional Resources</h2>

<p>Please see the following the additional resources.</p>

<ul>
  <li><a href="https://arrow.apache.org/docs/index.html">Apache Arrow Documentation</a></li>
  <li><a href="https://duckdb.org/docs/">DuckDB Documentation</a></li>
</ul>
  </section>

  
  
  

  <section class="background" data-size="page">
    <!--
  background: ;
  dark: ;
  size: ;
-->


<div class="post-nav">
  <span>
    
      <i class="icon fa-solid fa-angle-left"></i> Previous post<br>
      <a href="/set-website/preview/pr-20/2022/11/27/Diagrams-as-Code.html">
        Tip of the Week: Diagrams as Code
      </a>
    
  </span>
  <span>
    
      Next post <i class="icon fa-solid fa-angle-right"></i><br>
      <a href="/set-website/preview/pr-20/2022/12/12/Remove-Unused-Code-to-Avoid-Decay.html">
        Tip of the Week: Remove Unused Code to Avoid Software Decay
      </a>
    
  </span>
</div>
  </section>


    </main>
    


<footer class="background" style="--image: url('/set-website/preview/pr-20/images/background.jpg')" data-dark="true" data-size="wide">
  <!--
    <div>
      Extra details like contact info or address
    </div>
  -->

  <div>
    
      
      
      



  <div class="button-wrapper">
    <a class="button" href="https://github.com/CU-DBMI" data-tooltip="GitHub" data-style="bare" aria-label="GitHub">
      <i class="icon fa-brands fa-github"></i>
      
    </a>
  </div>


    
  </div>

  <div>
    © 2023
    Software Engineering Team
      |   Built with
    <a href="https://github.com/greenelab/lab-website-template">
      Lab Website Template
    </a>
  </div>

  <input type="checkbox" class="dark-toggle" data-tooltip="Dark mode" aria-label="toggle dark mode" oninput="onDarkToggleChange(event)">
</footer>

  </body>
</html>
