<!DOCTYPE html>
<html lang="en" data-dark="false">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <!--
  put your analytics (e.g. Google Analytics) tracking code here
-->

  <!--
  put your search engine verification (e.g. Google Search Console) tag here
-->

  

























<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Tip of the Week: Using Python and Anaconda with the Alpine HPC Cluster | Software Engineering Team</title>

<link rel="icon" href="/set-website/preview/pr-24/images/icon.png">

<meta name="title" content="Tip of the Week: Using Python and Anaconda with the Alpine HPC Cluster">
<meta name="description" content="The software engineering team of the Department of Biomedical Informatics at the University of Colorado Anschutz">

<meta property="og:title" content="Tip of the Week: Using Python and Anaconda with the Alpine HPC Cluster">
<meta property="og:site_title" content="Software Engineering Team">
<meta property="og:description" content="The software engineering team of the Department of Biomedical Informatics at the University of Colorado Anschutz">
<meta property="og:url" content="">
<meta property="og:image" content="/set-website/preview/pr-24/images/share.jpg">
<meta property="og:locale" content="en_US">

<meta property="twitter:title" content="Tip of the Week: Using Python and Anaconda with the Alpine HPC Cluster">
<meta property="twitter:description" content="The software engineering team of the Department of Biomedical Informatics at the University of Colorado Anschutz">
<meta property="twitter:url" content="">
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:image" content="/set-website/preview/pr-24/images/share.jpg">


  <meta name="author" content="dave-bunten">
  <meta property="og:type" content="article">
  <meta property="og:updated_time" content="2023-09-11T21:51:11+00:00">
  <meta property="article:published_time" content="2023-07-07T00:00:00+00:00">
  <meta property="article:modified_time" content="2023-09-11T21:51:11+00:00">
  <meta name="revised" content="2023-09-11T21:51:11+00:00">


<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "BlogPosting",
      "author": { "@type": "Person", "name": "Tip of the Week: Using Python and Anaconda with the Alpine HPC Cluster" },
      "datePublished": "2023-07-07T00:00:00+00:00",
      "dateModified": "2023-09-11T21:51:11+00:00",
    
    "name": "Tip of the Week: Using Python and Anaconda with the Alpine HPC Cluster",
    "description": "The software engineering team of the Department of Biomedical Informatics at the University of Colorado Anschutz",
    "headline": "Tip of the Week: Using Python and Anaconda with the Alpine HPC Cluster",
    "publisher": {
      "@type": "Organization",
      "logo": { "@type": "ImageObject", "url": "/set-website/preview/pr-24/images/icon.png" }
    },
    "url": ""
  }
</script>

<link rel="alternate" type="application/rss+xml" href="/set-website/preview/pr-24/feed.xml">

  <!-- Google Fonts -->
<!-- automatically get url from fonts used in theme file -->

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?display=swap&&family=Barlow:ital,wght@0,200;0,400;0,500;0,600;1,200;1,400;1,500;1,600&amp;family=Roboto+Mono:ital,wght@0,200;0,400;0,500;0,600;1,200;1,400;1,500;1,600" rel="stylesheet">

<!-- Font Awesome icons (load asynchronously due to size) -->

<link href="https://use.fontawesome.com/releases/v6.3.0/css/all.css" rel="preload" as="style" onload="this.onload = null; this.rel = 'stylesheet';">
<noscript>
  <link href="https://use.fontawesome.com/releases/v6.3.0/css/all.css" rel="stylesheet">
</noscript>

  <!-- third party styles -->
<!-- https://stylishthemes.github.io/Syntax-Themes/pygments/ -->
<link href="https://cdn.jsdelivr.net/gh/StylishThemes/Syntax-Themes/pygments/css-github/pygments-tomorrow-night-eighties.css" rel="stylesheet">

<!-- include all sass in styles folder -->


  
    <link href="/set-website/preview/pr-24/_styles/-theme.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/alert.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/all.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/anchor.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/background.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/body.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/bold.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/button.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/card.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/checkbox.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/citation.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/code.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/cols.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/dark-toggle.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/feature.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/figure.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/float.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/font.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/footer.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/form.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/grid.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/header.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/heading.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/highlight.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/icon.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/image.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/link.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/list.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/main.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/paragraph.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/portrait.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/post-excerpt.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/post-info.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/post-nav.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/quote.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/rule.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/search-box.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/search-info.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/section.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/table.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/tags.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/textbox.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/tooltip.css" rel="stylesheet">
  

  
    <link href="/set-website/preview/pr-24/_styles/util.css" rel="stylesheet">
  


<!-- include all css in styles folder -->



  <!-- third party scripts -->
<script src="https://unpkg.com/@popperjs/core@2" defer></script>
<script src="https://unpkg.com/tippy.js@6" defer></script>
<script src="https://unpkg.com/mark.js@8" defer></script>

<!-- include all js in scripts folder -->


  <script src="/set-website/preview/pr-24/_scripts/anchors.js"></script>

  <script src="/set-website/preview/pr-24/_scripts/dark-mode.js"></script>

  <script src="/set-website/preview/pr-24/_scripts/fetch-tags.js"></script>

  <script src="/set-website/preview/pr-24/_scripts/search.js"></script>

  <script src="/set-website/preview/pr-24/_scripts/site-search.js"></script>

  <script src="/set-website/preview/pr-24/_scripts/tooltip.js"></script>


</head>

  <body>
    







<header class="background" style="--image: url('/set-website/preview/pr-24/images/background.jpg')" data-dark="true">
  <a href="/set-website/preview/pr-24/" class="home">
    
      <span class="logo">
        
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="-60 -50 120 100">
  <defs>
    <lineargradient id="gradient" gradientunits="userSpaceOnUse" x1="-10" y1="0" x2="10" y2="0">
      <stop stop-color="#7e57c2" offset="0%"></stop>
      <stop stop-color="#2196f3" offset="100%"></stop>
    </lineargradient>
  </defs>
  <style>
    path {
      stroke-dasharray: var(--length);
      animation: draw 1s both;
    }

    @keyframes draw {
      from {
        stroke-dashoffset: var(--length);
      }
      to {
        stroke-dashoffset: 0;
      }
    }

    .bracket {
      --length: 56.569;
    }

    .slash {
      --length: 63.246;
      animation-delay: 0.75s;
    }
  </style>
  <g fill="none" stroke="url(#gradient)" stroke-width="8" stroke-linecap="round" stroke-linejoin="round">
    <path class="bracket" d="M -30 -20 L -50 0 L -30 20"></path>
    <path class="bracket" d="M 30 20 L 50 0 L 30 -20"></path>
    <path class="slash" d="M 10 -30 L -10 30"></path>
  </g>
</svg>

        
      </span>
    
    
      <span class="title" data-tooltip="Home">
        
          <span>Software Engineering Team</span>
        
        
          <span>CU Dept. of Biomedical Informatics</span>
        
      </span>
    
  </a>

  <input class="nav-toggle" type="checkbox" aria-label="show/hide nav">

  <nav>
    
    
      
        <a href="/set-website/preview/pr-24/about/" data-tooltip="">
          About
        </a>
      
    
      
        <a href="/set-website/preview/pr-24/portfolio/" data-tooltip="">
          Portfolio
        </a>
      
    
      
        <a href="/set-website/preview/pr-24/blog/" data-tooltip="Musings and miscellany">
          Blog
        </a>
      
    
  </nav>
</header>

    <main>
      <!--
  modify main content of page:
  - add section breaks
  - attach section properties
  - wrap each table in div to allow for scrolling
  - filter out blank sections
-->








  
  
  

  <section class="background" data-size="page">
    <h1 class="center">Tip of the Week: Using Python and Anaconda with the Alpine HPC Cluster</h1>

<div class="post-info">
  
    
    
      

<div class="portrait-wrapper">
  <a href="/set-website/preview/pr-24/members/dave-bunten.html" class="portrait" data-style="tiny" aria-label="Dave Bunten (@d33bs)">
    <img src="/set-website/preview/pr-24/images/dave-bunten.jpg" class="portrait-image" alt="member portrait" loading="lazy" onerror="this.src = '/set-website/preview/pr-24/images/fallback.svg'; this.onerror = null;">

    
      <span class="portrait-text">
        
          <span class="portrait-name">
            Dave Bunten (@d33bs)
          </span>
        

        
          <span class="portrait-role">
            
            <i class="icon fa-solid fa-code"></i>
            <span>Research Data Engineer</span>
          </span>
        
      </span>
    
  </a>
</div>

    
  

  
  

  
    <span data-tooltip="Originally published on">
      <i class="icon fa-regular fa-calendar"></i>
      <span>July 07, 2023</span>
    </span>
  

  
    <span data-tooltip="Last updated on">
      <i class="icon fa-solid fa-clock-rotate-left"></i>
      <span>September 11, 2023</span>
    </span>
  
</div>


  


  <div class="tags" data-link="/set-website/preview/pr-24/blog">
    
      <a href="/set-website/preview/pr-24/blog?search=%22tag:%20tip-of-the-week%22" class="tag" data-tooltip='Show items with the tag "tip-of-the-week"'>
        tip-of-the-week
      </a>
    
      <a href="/set-website/preview/pr-24/blog?search=%22tag:%20software%22" class="tag" data-tooltip='Show items with the tag "software"'>
        software
      </a>
    
      <a href="/set-website/preview/pr-24/blog?search=%22tag:%20Python%22" class="tag" data-tooltip='Show items with the tag "Python"'>
        Python
      </a>
    
      <a href="/set-website/preview/pr-24/blog?search=%22tag:%20Anaconda%22" class="tag" data-tooltip='Show items with the tag "Anaconda"'>
        Anaconda
      </a>
    
      <a href="/set-website/preview/pr-24/blog?search=%22tag:%20high-performance-compute%22" class="tag" data-tooltip='Show items with the tag "high-performance-compute"'>
        high-performance-compute
      </a>
    
      <a href="/set-website/preview/pr-24/blog?search=%22tag:%20slurm%22" class="tag" data-tooltip='Show items with the tag "slurm"'>
        slurm
      </a>
    
      <a href="/set-website/preview/pr-24/blog?search=%22tag:%20globus%22" class="tag" data-tooltip='Show items with the tag "globus"'>
        globus
      </a>
    
  </div>
  </section>

  
  
  

  <section class="background" data-size="page">
    <!--
  background: ;
  dark: ;
  size: ;
-->


<h1 id="tip-of-the-week-using-python-and-anaconda-with-the-alpine-hpc-cluster">Tip of the Week: Using Python and Anaconda with the Alpine HPC Cluster</h1>

<div class="alert" style="--color: #0ea5e9">
  
  <i class="icon fa-solid fa-circle-info"></i>
  <div class="alert-content">
    
<p>Each week we seek to provide a software tip of the week geared towards helping you achieve your software goals. Views
expressed in the content belong to the content creators and not the organization, its affiliates, or employees. If you
have any software questions or suggestions for an upcoming tip of the week, please don’t hesitate to reach out to
#software-engineering on Slack or email DBMISoftwareEngineering at olucdenver.onmicrosoft.com</p>

  </div>
</div>

<!-- excerpt start -->

<p>This post is intended to help demonstrate the use of Python on <a href="https://curc.readthedocs.io/en/latest/clusters/alpine/index.html">Alpine</a>, a <a href="https://en.wikipedia.org/wiki/High-performance_computing">High Performance Compute (HPC) cluster</a> hosted by the <a href="https://www.colorado.edu/rc/">University of Colorado Boulder’s Research Computing</a>.
We use Python here by way of <a href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">Anaconda</a> environment management to run code on Alpine.
This readme will cover a background on the technologies and how to use the contents of <a href="https://github.com/CU-DBMI/example-hpc-alpine-python">an example project repository</a> as though it were a project you were working on and wanting to run on Alpine.</p>

<!-- excerpt end -->

<pre class="mermaid">
flowchart LR
    subgraph repo["📦 Software repository"]
        direction LR
        runscript["📄 Run script"]
        subgraph condaenv[" 🌐 Anaconda environment  "]
            pythoncode["📄 Python code"]
        end

    end
    subgraph alpine["🖥️ Alpine"]
        subgraph spacer1[" "]
            subgraph spacer2["⚙️⚙️⚙️"]
            end
        end
    end

    repo --&gt; | process on | alpine

style condaenv fill:#FEF3C7,stroke:#D97706;
style repo fill:#ffffff,stroke:#444444;
style alpine fill:#ffffff,stroke:#444444;
style spacer1 fill:#ffffff,stroke:#ffffff;
style spacer2 fill:#ffffff,stroke:#ffffff;
</pre>
<script type="module">
  import mermaid from 'https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true });
</script>

<p><em>Diagram showing a repository’s work as being processed on Alpine.</em></p>

<h2 id="table-of-contents">Table of Contents</h2>

<ol>
  <li>
<a href="#background"><strong>Backround:</strong></a> here we cover the background of Alpine and related technologies.</li>
  <li>
<a href="#implementation"><strong>Implementation:</strong></a> in this section we use the contents of <a href="https://github.com/CU-DBMI/example-hpc-alpine-python">an example project repository</a> on Alpine.</li>
</ol>

<h2 id="background">Background</h2>

<h3 id="why-would-i-use-alpine">Why would I use Alpine?</h3>

<pre class="mermaid">
flowchart LR
    subgraph alpine["🖥️ Alpine"]
        direction TB
        subgraph resources["   💪 Compute Resources  "]
            check1["✅"]
        end
        subgraph time["   🕑 Long-running Jobs  "]
            check2["✅"]
        end
        subgraph collaborations["   👥 Collaborations  "]
            check3["✅"]
        end
    end

style alpine fill:#ffffff,stroke:#444444;
style check1 fill:#D1FAE5,stroke:#D1FAE5;
style check2 fill:#D1FAE5,stroke:#D1FAE5;
style check3 fill:#D1FAE5,stroke:#D1FAE5;
style alpine fill:#ffffff,stroke:#444444;
</pre>

<p><em>Diagram showing common benefits of Alpine and HPC clusters.</em></p>

<p>Alpine is a <a href="https://en.wikipedia.org/wiki/High-performance_computing">High Performance Compute (HPC) cluster</a>.
HPC environments provide shared computer hardware resources like <a href="https://en.wikipedia.org/wiki/Computer_memory">memory</a>, <a href="https://en.wikipedia.org/wiki/Central_processing_unit">CPU</a>, <a href="https://en.wikipedia.org/wiki/Graphics_processing_unit">GPU</a> or others to run performance-intensive work.
Reasons for using Alpine might include:</p>

<ul>
  <li>
<strong>Compute resources:</strong> Leveraging otherwise cost-prohibitive amounts of memory, CPU, GPU, etc. for processing data.</li>
  <li>
<strong>Long-running jobs:</strong> Completing long-running processes which may take hours or days to complete.</li>
  <li>
<strong>Collaborations:</strong> Sharing a single implementation environment for reproducibility within a group (avoiding “works on my machine” inconsistency issues).</li>
</ul>

<h3 id="how-does-alpine-work">How does Alpine work?</h3>

<pre class="mermaid">
flowchart LR
    users["👥 Users"]
    subgraph alpine["🖥️ Alpine"]
        slurm["🗓️ Slurm"]
        subgraph loginnodes["🔑 Login node(s)"]
            acompile["📄 acompile"]
            slurmcmd["⌨️ Slurm cmd's"]
        end
        subgraph computenodes["⚙️ Compute node(s)"]
            hardware["⚙️ Compute\nResources"]
            modules["💿 Software via\nmodules pkg"]
        end

        subgraph storage["📂 Storage"]
            localstorage["📁 Local Storage\n(sometimes temporary)"]
        end
    end
    remotestorage["📁 External Storage\n(user specified / configured)"]

    users --&gt; |\"preconfigured\nSlurm access\"| acompile --&gt; slurm
    users --&gt; |\"direct access\"| slurmcmd --&gt; slurm
    slurm --&gt; |\"schedules\n\(shared) use of\"| hardware
    slurm --&gt; |\"provides\naccess to\"| modules --&gt; |\"which may\n leverage\"| hardware
    hardware --&gt; |\"may deliver\nresults to\"| localstorage
    hardware --&gt; |\"or deliver\nresults to\"| remotestorage

style alpine fill:#ffffff,stroke:#444444;
style slurm fill:#F0F9FF,stroke:#075985;
</pre>

<p><em>Diagram showing high-level user workflow and Alpine components.</em></p>

<p>Alpine’s compute resources are used through compute nodes in a system called <a href="https://github.com/SchedMD/slurm">Slurm</a>.
Slurm is a system that a large number of users to run jobs on a cluster of computers; the system figures out how to use all the computers in the cluster to execute all the user’s jobs fairly (i.e., giving each user approximately equal time and resources on the cluster). A <em>job</em> is a request to run something, e.g. a bash script or a program, along with specifications about how much RAM and CPU it needs, how long it can run, and how it should be executed.</p>

<p>Slurm’s role in general is to take in a job (submitted via the <code class="language-plaintext highlighter-rouge">sbatch</code> command) and put it into a <em>queue</em> (also called a “partition” in Slurm). For each job in the queue, Slurm constantly tries to find a computer in the cluster with enough resources to run that job, then when an available computer is found runs the program the job specifies on that computer. As the program runs, Slurm records its output to files and finally reports the program’s exit status (either completed or failed) back to the job manager.</p>

<p>Importantly, jobs can either be marked as <em>interactive</em> or <em>batch</em>. When you submit an interactive job, <code class="language-plaintext highlighter-rouge">sbatch</code> will pause while waiting for the job to start and then connect you to the program, so you can see its output and enter commands in real time. On the other hand, a <em>batch</em> job will return immediately; you can see the progress of your job using <code class="language-plaintext highlighter-rouge">squeue</code>, and you can typically see the output of the job in the folder from which you ran <code class="language-plaintext highlighter-rouge">sbatch</code> unless you specify otherwise.
Data for or from Slurm work may be stored temporarily on local storage or on user-specific external (remote) storage.</p>

<div class="alert" style="--color: #6366f1">
  
  <i class="icon fa-solid fa-circle-question"></i>
  <div class="alert-content">
    
<p><strong>Wait, what are “nodes”?</strong></p>

<p>A simplified way to understand the architecture of Slurm on Alpine is through login and compute “nodes” (computers).
Login nodes act as a place to prepare and submit jobs which will be completed on compute nodes. Login nodes are never used to execute Slurm jobs, whereas compute nodes are exclusively accessed via a job.
Login nodes have limited resource access and are not recommended for running procedures.</p>

  </div>
</div>

<p>One can interact with Slurm on Alpine by use of <a href="https://curc.readthedocs.io/en/latest/clusters/alpine/examples.html">Slurm interfaces and directives</a>.
A quick way of accessing Alpine resources is through the use of the <code class="language-plaintext highlighter-rouge">acompile</code> command, which starts an interactive job on a compute node with some typical default parameters for the job. Since <code class="language-plaintext highlighter-rouge">acompile</code> requests very modest resources (1 hour and 1 CPU core at the time of writing), you’ll typically quickly be connected to a compute node. For more intensive or long-lived interactive jobs, consider using <code class="language-plaintext highlighter-rouge">sinteractive</code>, which allows for more customization <a href="https://curc.readthedocs.io/en/latest/running-jobs/interactive-jobs.html">Interactive Jobs</a>.
One can also access Slurm directly through <a href="https://slurm.schedmd.com/quickstart.html#commands">various commands</a> on Alpine.</p>

<p>Many common software packages are available through the <a href="https://github.com/cea-hpc/modules">Modules package</a> on Alpine (<a href="https://curc.readthedocs.io/en/latest/compute/modules.html">UCB RC documentation: The Modules System</a>).</p>

<h3 id="how-does-slurm-work">How does Slurm work?</h3>

<pre class="mermaid">
flowchart LR
    subgraph alpine["🖥️ Alpine"]
        direction LR
        script["📄 Job script"]
        subgraph slurm["🗓️ Slurm"]
            queue["🕑 Queue"]
            processing["⚙️ Processing"]
            completion["✅ Completion\n(or cancellation)"]
        end
    end

    script --&gt; | Submit job\nto Slurm | queue
    queue --&gt; | Scheduled job\nis processed | processing
    processing --&gt; | Processing\ncompletes | completion
    queue --&gt; | Cancellation without\nprocessing| completion

style alpine fill:#ffffff,stroke:#444444;
style slurm fill:#F0F9FF,stroke:#075985;
</pre>

<p><em>Diagram showing how Slurm generally works.</em></p>

<p>Using Alpine effectively involves knowing how to leverage Slurm.
A simplified way to understand how Slurm works is through the following sequence.
Please note that some steps and additional complexity are omitted for the purposes of providing a basis of understanding.</p>

<ol>
  <li>
<strong>Create a job script:</strong> build a script which will configure and run procedures related to the work you seek to accomplish on the HPC cluster.</li>
  <li>
<strong>Submit job to Slurm:</strong> ask Slurm to run a set of commands or procedures.</li>
  <li>
<strong>Job queue:</strong> Slurm will queue the submitted job alongside others (recall that the HPC cluster is a shared resource), providing information about progress as time goes on.</li>
  <li>
<strong>Job processing:</strong> Slurm will run the procedures in the job script as scheduled.</li>
  <li>
<strong>Job completion or cancellation:</strong> submitted jobs eventually may reach completion or cancellation states with saved information inside Slurm regarding what happened.</li>
</ol>

<h3 id="how-do-i-store-data-on-alpine">How do I store data on Alpine?</h3>

<pre class="mermaid">
flowchart LR
    users["👥 Users"]
    subgraph alpine["🖥️ Alpine"]
        slurm["🗓️ Slurm"]
        processjobs["Processed jobs"]
        subgraph storage["📂 Storage"]
            localstorage["📁 Local Storage\n(sometimes temporary)"]
        end
    end
    remotestorage["📁 External Storage\n(user specified / configured)"]

    users --&gt; |run their\nwork with| slurm
    slurm --&gt; |runs code| processjobs
    processjobs --&gt; |may deliver\nresults to| localstorage
    processjobs --&gt; |or deliver\nresults to| remotestorage

style alpine fill:#ffffff,stroke:#444444;
style slurm fill:#F0F9FF,stroke:#075985;
</pre>

<p>Data used or produced by your processed jobs on Alpine may use a number of different data storage locations.
Be sure to follow <a href="https://curc.readthedocs.io/en/latest/additional-resources/policies.html#acceptable-data-storage-and-use">the Acceptable data storage and use policies of Alpine</a>, avoiding the use of certain sensitive information and other items.
These may be distinguished in two ways:</p>

<ol>
  <li>
    <p><strong>Alpine local storage (sometimes temporary):</strong> Alpine provides a number of temporary data storage locations for accomplishing your work.
⚠️ <em>Note: some of these locations may be periodically purged and are not a suitable location for long-term data hosting (<a href="https://curc.readthedocs.io/en/latest/additional-resources/policies.html#scratch-file-purge">see here for more information</a>)!</em><br>
Storage locations available (<a href="https://curc.readthedocs.io/en/latest/compute/filesystems.html">see this link for full descriptions</a>):</p>

    <ul>
      <li>
<strong>Home filesystem:</strong> 2 GB of backed up space under <code class="language-plaintext highlighter-rouge">/home/$USER</code> (where <code class="language-plaintext highlighter-rouge">$USER</code> is your RMACC or Alpine username).</li>
      <li>
<strong>Projects filesystem:</strong> 250 GB of backed up space under <code class="language-plaintext highlighter-rouge">/projects/$USER</code> (where <code class="language-plaintext highlighter-rouge">$USER</code> is your RMACC or Alpine username).</li>
      <li>
<strong>Scratch filesystem:</strong> 10 TB (10,240 GB) of space <strong><em>which is not backed up</em></strong> under <code class="language-plaintext highlighter-rouge">/scratch/alpine/$USER</code> (where <code class="language-plaintext highlighter-rouge">$USER</code> is your RMACC or Alpine username).</li>
    </ul>
  </li>
  <li>
    <p><strong>External / remote storage:</strong> Users are encouraged to explore external data storage options for long-term hosting.<br>
Examples may include the following:</p>

    <ul>
      <li>
<strong><a href="https://www.colorado.edu/rc/resources/petalibrary">PetaLibrary</a></strong>: subsidized external storage host from University of Colorado Boulder’s Research Computing (requires specific arrangements outside of Alpine).</li>
      <li>
<strong>Cloud hosting:</strong> <a href="https://en.wikipedia.org/wiki/Object_storage">object storage</a> and related data hosting options from cloud providers like <a href="https://azure.microsoft.com/en-us">Microsoft Azure</a>, <a href="https://cloud.google.com/">Google Cloud</a> (<a href="https://www.cuanschutz.edu/offices/office-of-information-technology/tools-services/google-cloud-platform">internal CU Anschutz GC information</a>), or <a href="https://aws.amazon.com/">Amazon Web Services</a>.</li>
      <li>
<strong>Others:</strong> additional options include third-party “storage as a service” offerings like Google Drive or Dropbox and/or external servers maintained by other groups.</li>
    </ul>
  </li>
</ol>

<h3 id="how-do-i-send-or-receive-data-on-alpine">How do I send or receive data on Alpine?</h3>

<pre class="mermaid">
flowchart LR
    externalstorage["📁 External Storage\n(user specified / configured)"]
    subgraph alpine["🖥️ Alpine"]
        subgraph storage["📂 Storage"]
            localstorage["📁 Local Storage\n(sometimes temporary)"]
        end
    end

    externalstorage --&gt; | send data\nto Alpine | localstorage
    localstorage --&gt; | receive data\nfrom Alpine | externalstorage

style alpine fill:#ffffff,stroke:#444444;
</pre>

<p><em>Diagram showing external data storage being used to send or receive data on Alpine local storage.</em></p>

<p>Data may be sent to or gathered from Alpine using a number of different methods.
These may vary contingent on the external data storage being referenced, the code involved, or your group’s available resources.
Please reference the following documentation from the University of Colorado Boulder’s Research Computing regarding data transfers: <a href="https://curc.readthedocs.io/en/latest/compute/data-transfer.html">The Compute Environment - Data Transfer</a>.
<strong>Please note:</strong> due to the authentication configuration of Alpine many local or SSH-key based methods are not available for CU Anschutz users.
As a result, <a href="https://www.globus.org/">Globus</a> represents one of the best options available (see <a href="#3-%F0%9F%93%82-transfer-data-results">3. 📂 Transfer data results</a> below). While the Globus tutorial in this document describes how you can download data from Alpine to your computer, note that you can also use Globus to transfer data to Alpine from your computer.</p>

<h2 id="implementation">Implementation</h2>

<pre class="mermaid">
flowchart LR
    users["(0. Gain access)\n👥 CU Anschutz\nUsers"]
    subgraph alpine["🖥️ Alpine"]
        direction LR
        alpineterminal1["(1. Prepare code)\n⌨️ git clone"]
        alpineterminal2["(2. Implement code)\n⌨️ Process run script"]
        subgraph repo["📦 This repo"]
            direction TB
            runscript["📄 Run script"]
            subgraph condaenv[" 🌐 Anaconda environment  "]
                pythoncode["📄 Python code"]
            end
        end
        subgraph slurmjob["🗓️ Slurm processing"]
            direction LR
            processing["⚙️ Processing"]
        end
        subgraph storage["📂 Storage"]
            localstorage["(3. Gather data)\n📁 Local Storage\n(sometimes temporary)"]
        end
    end

    users --&gt; | gain access\nvia RMACC acct.| alpineterminal1
    alpineterminal1 --&gt; | bring repo\n contents to Alpine | repo
    runscript --&gt; |run\nscript file| alpineterminal2
    alpineterminal2 --&gt; |submit\nSlurm job| processing
    processing --&gt; | completed job\n sends data to| localstorage
    pythoncode -.-&gt; | run python code\nwithin conda env |processing

style condaenv fill:#FEF3C7,stroke:#D97706;
style repo fill:#ffffff,stroke:#444444;
style alpine fill:#ffffff,stroke:#444444;
style users fill:#D1FAE5,stroke:#444444;
style alpineterminal1 fill:#D1FAE5,stroke:#444444;
style alpineterminal2 fill:#D1FAE5,stroke:#444444;
style localstorage fill:#D1FAE5,stroke:#444444;
</pre>

<p><em>Diagram showing how <a href="https://github.com/CU-DBMI/example-hpc-alpine-python">an example project repository</a> may be used within Alpine through primary steps and processing workflow.</em></p>

<p>Use the following steps to understand how Alpine may be used with <a href="https://github.com/CU-DBMI/example-hpc-alpine-python">an example project repository</a> to run example Python code.</p>

<h3 id="0--gain-alpine-access">0. 🔑 Gain Alpine access</h3>

<p>First you will need to gain access to Alpine.
This access is provided to members of the University of Colorado Anschutz through <a href="https://rmacc.org/">RMACC</a> and is separate from other credentials which may be provided by default in your role.
Please see the following guide from the University of Colorado Boulder’s Research Computing covering requesting access and generally how this works for members of the University of Colorado Anschutz.</p>

<ul>
  <li>
<strong>RMACC Access to Alpine:</strong> <a href="https://curc.readthedocs.io/en/latest/access/rmacc.html">https://curc.readthedocs.io/en/latest/access/rmacc.html</a>
</li>
</ul>

<h3 id="1-️-prepare-code-on-alpine">1. 🛠️ Prepare code on Alpine</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>username@xsede.org@login-ciX ~]<span class="nv">$ </span><span class="nb">cd</span> /projects/<span class="nv">$USER</span>
<span class="o">[</span>username@xsede.org@login-ciX username@xsede.org]<span class="nv">$ </span>git clone https://github.com/CU-DBMI/example-hpc-alpine-python
Cloning into <span class="s1">'example-hpc-alpine-python'</span>...
... git output ...
<span class="o">[</span>username@xsede.org@login-ciX username@xsede.org]<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> example-hpc-alpine-python
... <span class="nb">ls </span>output ...
</code></pre></div></div>

<p><em>An example of what this preparation section might look like in your Alpine terminal session.</em></p>

<p>Next we will prepare our code within Alpine.
We do this to balance the fact that we may develop and source control code outside of Alpine.
In the case of this example work, we assume git as an interface for GitHub as the source control host.</p>

<p>Below you’ll find the general steps associated with this process.</p>

<ol>
  <li>Login to the Alpine command line (<a href="https://curc.readthedocs.io/en/latest/access/rmacc.html#logging-in-to-open-ondemand">reference this guide</a>).</li>
  <li>Change directory into the <strong>Projects filesystem</strong> (generally we’ll assume processed data produced by this code are large enough to warrant the need for additional space):<br> <code class="language-plaintext highlighter-rouge">cd /projects/$USER</code>
</li>
  <li>Use <code class="language-plaintext highlighter-rouge">git</code> (built into Alpine by default) commands to clone this repo:<br> <code class="language-plaintext highlighter-rouge">git clone https://github.com/CU-DBMI/example-hpc-alpine-python</code>
</li>
  <li>Verify the contents were received as desired (this should show the contents of <a href="https://github.com/CU-DBMI/example-hpc-alpine-python">an example project repository</a>):<br> <code class="language-plaintext highlighter-rouge">ls -l example-hpc-alpine-python</code>
</li>
</ol>

<!--- anchor for referencing github authentication guidance directly --->

<p><a id="prepare-code-authenticate"></a></p>

<div class="alert" style="--color: #6366f1">
  
  <i class="icon fa-solid fa-circle-question"></i>
  <div class="alert-content">
    
<p><strong>What if I need to authenticate with GitHub?</strong></p>

<p>There are times where you may need to authenticate with GitHub in order to accomplish your work.
From a GitHub perspective, you will want to use either GitHub Personal Access Tokens (PAT) (recommended by GitHub) or SSH keys associated with the <code class="language-plaintext highlighter-rouge">git</code> client on Alpine.
Note: if you are prompted for a username and password from <code class="language-plaintext highlighter-rouge">git</code> when accessing a GitHub resource, the password is now associated with other keys like PAT’s instead of your user’s password (<a href="https://github.blog/changelog/2021-08-12-git-password-authentication-is-shutting-down">reference</a>).
See the following guide from GitHub for more information on how authentication through <code class="language-plaintext highlighter-rouge">git</code> to GitHub works:</p>

<ul>
  <li>
<strong>GitHub - Authenticating with GitHub from Git:</strong> <a href="https://docs.github.com/en/get-started/quickstart/set-up-git#authenticating-with-github-from-git">https://docs.github.com/en/get-started/quickstart/set-up-git#authenticating-with-github-from-git</a>
</li>
</ul>

  </div>
</div>

<h3 id="2-️-implement-code-on-alpine">2. ⚙️ Implement code on Alpine</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>username@xsede.org@login-ciX ~]<span class="nv">$ </span>sbatch <span class="nt">--export</span><span class="o">=</span><span class="nv">CSV_FILEPATH</span><span class="o">=</span><span class="s2">"/projects/</span><span class="nv">$USER</span><span class="s2">/example_data.csv"</span> example-hpc-alpine-python/run_script.sh
<span class="o">[</span>username@xsede.org@login-ciX username@xsede.org]<span class="nv">$ </span><span class="nb">tail</span> <span class="nt">-f</span> example-hpc-alpine-python.out
... <span class="nb">tail </span>output <span class="o">(</span>ctrl/cmd + c to cancel<span class="o">)</span> ...
<span class="o">[</span>username@xsede.org@login-ciX username@xsede.org]<span class="nv">$ </span><span class="nb">head</span> <span class="nt">-n</span> 2 example_data.csvexample-hpc-alpine-python
... data output ...
</code></pre></div></div>

<p><em>An example of what this implementation section might look like in your Alpine terminal session.</em></p>

<p>After our code is available on Alpine we’re ready to run it using Slurm and related resources.
We use Anaconda to build a Python environment with specified packages for reproducibility.
The main goal of the Python code related to this work is to create a CSV file with random data at a specified location.
We’ll use <a href="https://slurm.schedmd.com/sbatch.html">Slurm’s <code class="language-plaintext highlighter-rouge">sbatch</code> command</a>, which submits batch scripts to Slurm using various options.</p>

<ol>
  <li>Use the <code class="language-plaintext highlighter-rouge">sbatch</code> command with exported variable <code class="language-plaintext highlighter-rouge">CSV_FILEPATH</code>.<br> <code class="language-plaintext highlighter-rouge">sbatch --export=CSV_FILEPATH="/projects/$USER/example_data.csv" example-hpc-alpine-python/run_script.sh</code>
</li>
  <li>After a short moment, use the <a href="https://en.wikipedia.org/wiki/Tail_(Unix)"><code class="language-plaintext highlighter-rouge">tail</code></a> command to observe the log file created by Slurm for this sbatch submission. This file can help you understand where things are at and if anything went wrong.<br> <code class="language-plaintext highlighter-rouge">tail -f example-hpc-alpine-python.out</code>
</li>
  <li>Once you see that the work has completed from the log file, take a look at the top 2 lines of the data file using the <a href="https://en.wikipedia.org/wiki/Head_(Unix)"><code class="language-plaintext highlighter-rouge">head</code></a> command to verify the data arrived as expected (column names with random values):<br> <code class="language-plaintext highlighter-rouge">head -n 2 example_data.csv</code>
</li>
</ol>

<h3 id="3--transfer-data-results">3. 📂 Transfer data results</h3>

<pre class="mermaid">
flowchart LR
    subgraph alpine["🖥️ Alpine"]
        localstorage["📄 /projects/$USER/example_data.csv"]
    end
    subgraph globus["☁️ Globus"]
        globusweb["🔁 Globus web interface"]
    end
    subgraph localmachine["🖥️ Local device"]
        personalconnect["🔁 Globus Connect Personal"]
        localdir["📄 /a_local_dir/example_data.csv"]
    end

    localstorage --&gt; | moves data\nfrom Alpine | globusweb
    globusweb --&gt; | interface \n from Globus | personalconnect
    personalconnect --&gt; | downloads \n local file | localdir

style alpine fill:#ffffff,stroke:#444444;
style globus fill:#ffffff,stroke:#444444;
style localmachine fill:#ffffff,stroke:#444444;
</pre>

<p><em>Diagram showing how example_data.csv may be transferred from Alpine to a local machine using Globus solutions.</em></p>

<p>Now that the example data output from the Slurm work is available we need to transfer that data to a local system for further use.
In this example we’ll use <a href="https://www.globus.org/">Globus</a> as a data transfer method from Alpine to our local machine.
<strong>Please note:</strong> always be sure to check data privacy and policy which change the methods or storage locations you may use for your data!</p>

<ol>
  <li>
<strong>Globus local machine configuration</strong>
    <ol>
      <li>Install <a href="https://www.globus.org/globus-connect-personal">Globus Connect Personal</a> on your local machine.</li>
      <li>During installation, you will be prompted to login to Globus. Use your ACCESS credentials to login.</li>
      <li>During installation login, note the label you provide to Globus. This will be used later, referenced as “Globus Connect Personal label”.</li>
      <li>Ensure you add and (<strong>importantly:</strong>) provide write access to a local directory via <strong>Globus Connect Personal - Preferences - Access</strong> where you’d like the data to be received from Alpine to your local machine.<br><br>
</li>
    </ol>
  </li>
  <li>
<strong>Globus web interface</strong>
    <ol>
      <li>Use your ACCESS credentials to login to the <a href="https://app.globus.org/login">Globus web interface</a>.</li>
      <li>
<strong>Configure File Manager <ins>left</ins> side (source selection)</strong>
        <ol>
          <li>Within the Globus web interface on the File Manager tab, use the <strong>Collection</strong> input box to search or select <strong>“CU Boulder Research Computing ACCESS”</strong>.</li>
          <li>Within the Globus web interface on the File Manager tab, use the <strong>Path</strong> input box to enter: <code class="language-plaintext highlighter-rouge">/projects/your_username_here/</code> (replacing “your_username_here” with your username from Alpine, including the “@” symbol if it applies).</li>
        </ol>
      </li>
      <li>
<strong>Configure File Manager <ins>right</ins> side (destination selection)</strong>
        <ol>
          <li>Within the Globus web interface on the File Manager tab, use the <strong>Collection</strong> input box to search or select the __Globus Connect Personal label you provided in earlier steps.</li>
          <li>Within the Globus web interface on the File Manager tab, use the <strong>Path</strong> input box to enter the local path which you made accessible in earlier steps.</li>
        </ol>
      </li>
      <li>
<strong>Begin Globus transfer</strong>
        <ol>
          <li>Within the Globus web interface on the File Manager tab on the left side (source selection), check the box next to the file <code class="language-plaintext highlighter-rouge">example_data.csv</code>.</li>
          <li>Within the Globus web interface on the File Manager tab on the left side (source selection), click the “Start ▶️” button to begin the transfer from Alpine to your local directory.</li>
          <li>After clicking the “Start ▶️” button, you may see a message in the top right with the message “Transfer request submitted successfully”. You can click the link to view the details associated with the transfer.</li>
          <li>After a short period, the file will be transferred and you should be able to verify the contents on your local machine.</li>
        </ol>
      </li>
    </ol>
  </li>
</ol>

<h2 id="further-references">Further References</h2>

<ul>
  <li><a href="https://www.colorado.edu/rc/">University of Colorado Boulder’s Research Computing</a></li>
  <li><a href="https://curc.readthedocs.io/en/latest/clusters/alpine/index.html">HPC Cluster Alpine Documentation</a></li>
  <li><a href="https://docs.github.com/en/get-started/getting-started-with-git">GitHub: Getting started with Git</a></li>
  <li><a href="https://slurm.schedmd.com/">Slurm Documentation</a></li>
  <li><a href="https://docs.globus.org/">Globus Documentation</a></li>
</ul>
  </section>

  
  
  

  <section class="background" data-size="page">
    <!--
  background: ;
  dark: ;
  size: ;
-->


<div class="post-nav">
  <span>
    
      <i class="icon fa-solid fa-angle-left"></i> Previous post<br>
      <a href="/set-website/preview/pr-24/2023/03/15/Automate-Software-Workflows-with-Github-Actions.html">
        Tip of the Week: Automate Software Workflows with GitHub Actions
      </a>
    
  </span>
  <span>
    
      Next post <i class="icon fa-solid fa-angle-right"></i><br>
      <a href="/set-website/preview/pr-24/2023/09/05/Python-Packaging-as-Publishing.html">
        Tip of the Week: Python Packaging as Publishing
      </a>
    
  </span>
</div>
  </section>


    </main>
    


<footer class="background" style="--image: url('/set-website/preview/pr-24/images/background.jpg')" data-dark="true" data-size="wide">
  <!--
    <div>
      Extra details like contact info or address
    </div>
  -->

  <div>
    
      
      
      



  <div class="button-wrapper">
    <a class="button" href="https://github.com/CU-DBMI" data-tooltip="GitHub" data-style="bare" aria-label="GitHub">
      <i class="icon fa-brands fa-github"></i>
      
    </a>
  </div>


    
  </div>

  <div>
    © 2023
    Software Engineering Team
      |   Built with
    <a href="https://github.com/greenelab/lab-website-template">
      Lab Website Template
    </a>
  </div>

  <input type="checkbox" class="dark-toggle" data-tooltip="Dark mode" aria-label="toggle dark mode" oninput="onDarkToggleChange(event)">
</footer>

  </body>
</html>
